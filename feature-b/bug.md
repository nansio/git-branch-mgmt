fix bug#3

fix bug#4

fix bug#5

fix bug#7